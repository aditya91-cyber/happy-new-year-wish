<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>New Year Surprise ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    background:#0f0f1a;
    color:#ffd700;
    font-family:Arial, sans-serif;
    text-align:center;
    margin:0;
    overflow-x:hidden;
}
.page{
    position:absolute;
    width:100%;
    height:100vh;
    top:0;
    left:0;
    padding:20px;
    transition:all 1s ease;
    box-sizing:border-box;
}
#page1::before{
    content:"";
    position:absolute;
    inset:0;
    background:url("background.jpg") center/cover no-repeat;
    filter:blur(10px);
    z-index:-1;
}
#page2{
    left:100%;
    background:linear-gradient(135deg,#ff4d6d,#ff9a9e);
    color:white;
    overflow-y:auto;
}
input,button,textarea{
    padding:10px 16px;
    font-size:16px;
    border-radius:10px;
    border:none;
    margin:10px auto;
    display:block;
}
button{
    background:#ff4d6d;
    color:white;
    cursor:pointer;
}
button:hover{ transform:scale(1.05); }
.text3d{
    font-size:28px;
    color:red;
    font-weight:bold;
    text-shadow:1px 1px 0 #87CEEB;
}
.typing{
    display:inline-block;
    white-space:nowrap;
    overflow:hidden;
    border-right:3px solid red;
    padding-right:6px;
    animation: blink 0.7s infinite;
}
@keyframes blink{50%{ border-color: transparent; }}
#loveFinal{
    font-size:28px;
    position:relative;
    font-weight:bold;
    color:white; 
    text-shadow:0 0 10px #f0ec0a,0 0 20px #f0ec0a,0 0 40px #f0ec0a;
    opacity:0;
    display:none;
    margin:20px auto;
    transition:opacity 1.5s ease, transform 0.8s ease;
}
#loveFinal.show{
    opacity:1;
    transform: scale(1.2);
    animation:lovePop 0.8s forwards;
}
@keyframes lovePop{
    0% { transform: scale(0.5); opacity:0; }
    50% { transform: scale(1.3); opacity:1; }
    100% { transform: scale(1); opacity:1; }
}
</style>
</head>
<body>

<audio id="fireSound" src="./fireworks.mp3" preload="auto"></audio>

<div class="page" id="page1">
<h1>üéâ Happy New Year üéâ</h1>

<button onclick="enableSound()">üîä Enable Sound</button>

<!-- New Friend Wish Inputs -->
<input id="userName" placeholder="Your Name">
<input id="friendName" placeholder="Friend's Name">
<textarea id="message" placeholder="Type your message (optional)"></textarea>
<button onclick="showGreeting()">Send Wish</button>

<div id="greeting"></div>
<button id="copyLinkBtn" onclick="copyLink()" style="display:none;">Copy Share Link</button>
<p id="copyText"></p>
</div>

<div class="page" id="page2">
<h1>üíñ Your New Year Wish üíñ</h1>
<div id="wishMessage" class="shayari"></div>
<div id="loveFinal">üéä Happy New Year! üéä</div>
</div>

<script>
let soundEnabled=false;
function enableSound(){
    fireSound.play().then(()=>{ 
        fireSound.pause(); 
        soundEnabled=true; 
        alert("Sound Enabled ‚ù§Ô∏è");
    });
}

// Show greeting with friend's name
function showGreeting(){
    let user = document.getElementById("userName").value.trim();
    let friend = document.getElementById("friendName").value.trim();
    let msg = document.getElementById("message").value.trim();

    if(!user || !friend){
        return alert("Please enter both names!");
    }

    document.getElementById("greeting").innerHTML = `
        <div class="text3d">
            <span id="typeText" class="typing"></span>
        </div>
    `;
    const text = `Happy New Year ${friend}! üéâ - From ${user}${msg ? ": " + msg : ""}`;
    let i=0; const speed=60;
    function type(){ 
        if(i<text.length){ 
            document.getElementById("typeText").textContent+=text.charAt(i); 
            i++; setTimeout(type,speed); 
        } 
    }
    type();
    if(soundEnabled){ fireSound.currentTime=0; fireSound.play(); }
    startFireworks();

    // Show Copy Link
    copyLinkBtn.style.display="block";

    // Update URL parameters
    const url = new URL(window.location.href);
    url.searchParams.set('user', user);
    url.searchParams.set('friend', friend);
    url.searchParams.set('message', msg);
    window.history.replaceState({}, '', url);

    // Auto go next page after 2s
    setTimeout(()=>{ goNextPage(user,friend,msg); }, 2000);
}

// Auto display if link has parameters
window.onload = function(){
    const params = new URLSearchParams(window.location.search);
    const user = params.get('user');
    const friend = params.get('friend');
    const msg = params.get('message');
    if(user && friend){
        goNextPage(user,friend,msg);
    }
};

// Next Page Show
function goNextPage(user,friend,msg){
    document.getElementById("page1").style.left="-100%";
    document.getElementById("page2").style.left="0";
    document.getElementById("wishMessage").innerHTML=`<strong>Happy New Year ${friend}! üéâ</strong><br>From ${user}${msg ? ": "+msg : ""}`;
    const love = document.getElementById("loveFinal");
    love.style.display="block";
    setTimeout(()=>love.classList.add("show"),100);
    startHearts();
}

// Fireworks & Hearts (from your code)
function launchFirework(){
    let fw=document.createElement("div");
    fw.className="firework";
    fw.style.left=Math.random()*90+"vw";
    fw.style.top=Math.random()*50+"vh";
    let color=`hsl(${Math.random()*360},100%,60%)`;
    for(let i=0;i<80;i++){
        let s=document.createElement("div");
        s.className="spark";
        s.style.background=color;
        let a=Math.random()*Math.PI*2;
        let d=60+Math.random()*60;
        s.style.setProperty("--x",Math.cos(a)*d+"px");
        s.style.setProperty("--y",Math.sin(a)*d+"px");
        fw.appendChild(s);
    }
    document.body.appendChild(fw);
    setTimeout(()=>fw.remove(),1500);
}
function startFireworks(){ let i=setInterval(launchFirework,200); setTimeout(()=>clearInterval(i),4000); }
function startHearts(){ for(let i=0;i<20;i++){ let h=document.createElement("div"); h.className="heart"; h.innerHTML="‚ù§Ô∏è"; h.style.left=Math.random()*95+"vw"; h.style.animationDuration=(3+Math.random()*2.5)+"s"; document.body.appendChild(h); setTimeout(()=>h.remove(),5000); } }

// Copy link function
function copyLink(){
    navigator.clipboard.writeText(window.location.href)
    .then(()=>{ document.getElementById("copyText").innerText="Link copied! Share with your friend."; })
    .catch(()=>{ document.getElementById("copyText").innerText="Failed to copy link."; });
}
</script>
</body>
</html>